(function(c){var a=function(d){d=d||{};for(var f=1;f<arguments.length;f++){var g=arguments[f];if(!g){continue;}for(var e in g){if(g.hasOwnProperty(e)){if(typeof g[e]==="object"){a(d[e],g[e]);}else{d[e]=g[e];}}}}return d;};var b=function(g,f){var e=f||this;e.eventRegistry={};var d={debug:false,eventErrorHandler:function(k,h,i,j){console.error('Event handler for "%s" resulted in error:',h,k,i,j);}};g=g||{};e.options=a({},d,g);e.on=function(h,i){if(e.options.debug){console.info('Attached handler to event "%s"',h,i);}if("undefined"===typeof e.eventRegistry[h]){e.eventRegistry[h]=[];}e.eventRegistry[h].push(i);};e.emmit=function(){var h=this;if(h instanceof b){h=null;}var j=(function(m){var l=[];for(var n in m){l.push(m[n]);}return l;})(arguments);var k=j.shift();if("undefined"===typeof e.eventRegistry[k]){if(e.options.debug){console.info('No handlers registered for event "%s"',k);}return;}var i=e.listeners(k);(function(n,l){for(var m in n){var o=(function(s,p,r,q){try{s.apply(h,r);}catch(t){q.eventErrorHandler(t,p,r,s);}});setTimeout(o.bind(h,n[m],k,l,e.options),0);}})(i,j);};e.removeListener=function(j,k){if("undefined"===typeof e.eventRegistry[j]){return false;}var h=e.eventRegistry[j].indexOf(k);if(h<0){return false;}e.eventRegistry[j].splice(h,1);return true;};e.removeAllListeners=function(h){if("undefined"!==typeof e.eventRegistry[h]){delete e.eventRegistry[h];}};e.listeners=function(h){if("undefined"!==typeof e.eventRegistry[h]){return e.eventRegistry[h];}return[];};e.forward=function(h){return function(){return e.emmit.bind(this,h).apply(this,arguments);};};return e;};c.EventMachine=function(d){return new b(d);};c.EventMachine.extend=function(e,d){return new b(d,e);};})(typeof module.exports!=="undefined"?module.exports:window);